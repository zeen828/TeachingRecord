[回上層目錄](../README.md)

# 關聯

## **Description [描述]**
我們預設一些資料庫格式來做關聯解說，

Users(使用者)
    id          - integer   - (local_key)
    name        - string
    car_id      - integer   - (foreign_key)

Phone(電話)
    id          - integer   - (local_key)
    name        - string
    user_id     - integer   - (foreign_key)

City(城市)
    id          - integer   - (local_key)
    name        - string

Areas(地區)
    id          - integer   - (local_key)
    name        - string
    city_id     - integer   - (foreign_key)

Cars(汽車)
    id          - integer   - (local_key)
    name        - string
    user_id     - integer   - (foreign_key)
    mechanic_id - integer   - (foreign_key)

Mechanics(修理工)
    id          - integer   - (local_key)
    name        - string

Roles(角色)
    id          - integer   - (local_key)
    name        - string

user_role(使用者&角色 關聯表)
    user_id     - integer   - (foreign_key)
    role_id     - integer   - (foreign_key)

## **Teaching & Examples [教學&範例]**
### 一對一
```php
// model設定
class Users extends Model
{
    /**
     * 模型一對一關聯設定
     */
    public function phone()
    {
        // return $this->hasOne(Models::class, 'foreign_key', 'local_key');
        return $this->hasOne('App\Models\Phone', 'user_id', 'id');
    }
}
class Phone extends Model
{
    /**
     * 模型一對一(反向)關聯設定
     */
    public function user()
    {
        // return $this->belongsTo(Models::class, 'foreign_key', 'other_key');
        return $this->belongsTo('App\Models\Users', 'user_id', 'id');
    }
}

// 使用
$user = Users::find(1);
var_dupm($user->phone);
$phone = Phone::find(1);
var_dupm($phone->user);
```

### 一對多
```php
// model設定
class Users extends Model
{
    /**
     * 模型一對多關聯設定
     */
    public function cars()
    {
        // return $this->hasMany(Models::class, 'foreign_key', 'local_key');
        return $this->hasMany('App\Models\Cars', 'user_id', 'id');
    }
}
class Cars extends Model
{
    /**
     * 模型一對多(反向)關聯設定
     */
    public function user()
    {
        // return $this->belongsTo(Models::class, 'foreign_key', 'owner_key');
        return $this->hasMany('App\Models\Users', 'user_id', 'id');
    }
}

// 使用
$user = Users::find(1);
var_dupm($user->cars);
$car = Cars::find(1);
var_dupm($car->user);
```

### 預載入

## **Reference article [參考文章]**
[參考文件](網址)

## **Author [作者]**
`Mr. Will`
